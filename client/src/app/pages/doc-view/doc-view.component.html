<div class="dashboard">
  <div class="main-container">
    <main class="main-content">
      <div *ngIf="!loading">
          <h2>{{ document.document.originalname }}</h2>

          <!-- Document Display -->
          <div *ngIf="documentType !== 'pdf'">
            <p-image
              [src]="documentUrl"
              alt="Document Image"
              width="700px"
              height="700px"
              [preview]="true"
            />
          </div>
          <div *ngIf="documentType === 'pdf'">
            <embed
              [src]="documentUrl"
              type="application/pdf"
              width="700px"
              height="700px"
            />
          </div>

          <!-- Key Information Display -->
          <div class="key-info-container">
            <h3>Key Information</h3>
            <div *ngIf="keyInfo">
              <div *ngFor="let key of keyInfoKeys()" class="key-info-item">
                <strong>{{ key }}:</strong>
                <span *ngIf="!editingKey || editingKey !== key">{{ keyInfo[key] }}</span>
                <input *ngIf="editingKey === key" [(ngModel)]="editValue" />

                <button *ngIf="!editingKey || editingKey !== key" (click)="copyToClipboard(keyInfo[key], key)" class="copy-button" [disabled]="copiedKey === key">
                  {{ copiedKey === key ? "Copied!" : "Copy" }}
                </button>

                <button *ngIf="editingKey === key" (click)="saveEdit(key)" class="save-button">
                  <i class="pi pi-check"></i>
                  <!-- PrimeNG check icon -->
                </button>
                <button *ngIf="editingKey === key" (click)="cancelEdit()" class="cancel-button">
                  <i class="pi pi-times"></i>
                  <!-- PrimeNG cross icon -->
                </button>

                <button *ngIf="(!editingKey || editingKey !== key) && !editDisabled" class="edit-button" (click)="startEdit(key)">
                  <i class="pi pi-pencil"></i>
                  <!-- PrimeNG pencil icon -->
                </button>
              </div>
            </div>
          </div>
          
          <!-- Share Document Form -->
          <div class="share-document-container">
            <h3>Share Document</h3>
            <form (ngSubmit)="shareDocument()">
              <div class="form-group">
                <label for="shareemail">User Email:</label>
                <input
                  id="shareemail"
                  [(ngModel)]="shareemail"
                  name="shareemail"
                  required
                />
              </div>
              <div class="form-group">
                <label for="shareAccessLevel">Access Level:</label>
                <select
                  id="shareAccessLevel"
                  [(ngModel)]="shareAccessLevel"
                  name="shareAccessLevel"
                  required
                >
                  <option value="read">Read</option>
                  <option value="full">Full</option>
                  <option value="edit">Edit</option>
                </select>
              </div>
              <button type="submit" class="share-button">Share</button>
            </form>
            <div *ngIf="shareMessage" class="share-message" [ngClass]="{'success': shareSuccess, 'error': !shareSuccess}">
              {{ shareMessage }}
            </div>
          </div>

      </div>
        
      <div *ngIf="loading">
        <p>Loading document...</p>
      </div>


    </main>
  </div>
</div>